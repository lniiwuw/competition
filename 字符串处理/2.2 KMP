2.2 KMP

//求给定子串p的next数组，记录前后缀相等的长度
void getnext(){
    nex[0] = nex[1] = 0;
    int n = strlen(p + 1);
    for(int i = 2; i <= n; i ++){
        int j = nex[i - 1];
        while(j && p[i] != p[j + 1])j = nex[j];
        nex[i] = (p[i] == p[j + 1]) ? j + 1 : 0;
    }
}

//查询在字符串p在s中的出现次数ans
void kmp(){
    int j = nex[1], ans = 0;
    int m = strlen(s + 1);
    for(int i = 1; i <= m; i ++){
        while(j && s[i] != p[j + 1])j = nex[j];
        if(s[i] == p[j + 1])j ++;
        if(j == n)ans ++;
    }
}
